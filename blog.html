<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¸”ë¡œê·¸ - ëŒ€ë°•ì² ê±°</title>
    <meta name="description" content="ëŒ€ë°•ì² ê±°ì˜ ì² ê±° ì„œë¹„ìŠ¤ ê´€ë ¨ ìµœì‹  ì†Œì‹ê³¼ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”. ìƒê°€, ì‚¬ë¬´ì‹¤, ì‹ë‹¹ ì² ê±° ì‚¬ë¡€ ë° ìœ ìš©í•œ íŒ.">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gray-matter/browser.min.js"></script>
</head>
<body>

    <header>
        <div class="container">
            <h1><a href="index.html" class="logo-link">ëŒ€ë°•ì² ê±°</a></h1>
            <nav>
                <ul>
                    <li><a href="index.html#services">ì² ê±° ì„œë¹„ìŠ¤</a></li>
                    <li><a href="index.html#areas">ì„œë¹„ìŠ¤ ì§€ì—­</a></li>
                    <li><a href="blog.html">ë¸”ë¡œê·¸</a></li>
                    <li><a href="index.html#contact">ë¬¸ì˜í•˜ê¸°</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <section id="blog-list">
            <div class="container">
                <h2>ëŒ€ë°•ì² ê±° ë¸”ë¡œê·¸</h2>
                <p>ì² ê±° ê´€ë ¨ ìœ ìš©í•œ ì •ë³´ì™€ ì‹¤ì œ ì‘ì—… ì‚¬ë¡€ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.</p>
                
                <div class="post-items" id="blog-posts-container">
                    <div style="text-align: center; padding: 2rem;">
                        <p>ë¸”ë¡œê·¸ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024 ëŒ€ë°•ì² ê±°. All Rights Reserved.</p>
        </div>
    </footer>

    <script>
        async function loadBlogPosts() {
            const container = document.getElementById('blog-posts-container');
            const posts = [];

            let postsList = [];

            // ìš°ì„  ê¸°ë³¸ ëª©ë¡ìœ¼ë¡œ ì‹œì‘
            postsList = [
                { filename: 'ê³ ì–‘ì‹œ-ì² ê±°ì—…ì²´-ì„ íƒ-ê°€ì´ë“œ-ì•ˆì „í•˜ê³ -ì‹ ë¢°í• -ìˆ˜-ìˆëŠ”-ì—…ì²´-ì°¾ê¸°.md' },
                { filename: 'í…ŒìŠ¤íŠ¸ ë¸”ë¡œê·¸ ê¸€.md' },
                { filename: 'suwon-office-demolition.md' }
            ];

            try {
                // GitHub APIë¡œ posts í´ë”ì˜ íŒŒì¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸° ì‹œë„
                console.log('ğŸ“¡ GitHub APIë¡œ ì‹¤ì‹œê°„ íŒŒì¼ ëª©ë¡ ê°€ì ¸ì˜¤ëŠ” ì¤‘...');
                const apiUrl = 'https://api.github.com/repos/leeyoungseok78/daebak-demolition/contents/posts';
                const response = await fetch(apiUrl, {
                    headers: {
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (response.ok) {
                    const files = await response.json();
                    // .md íŒŒì¼ë§Œ í•„í„°ë§
                    const apiPostsList = files
                        .filter(file => file.name.endsWith('.md'))
                        .map(file => ({ filename: file.name }));
                    
                    if (apiPostsList.length > 0) {
                        postsList = apiPostsList;
                        console.log(`âœ… GitHub APIë¡œ ${postsList.length}ê°œ íŒŒì¼ ë°œê²¬:`, postsList.map(p => p.filename));
                    } else {
                        console.log('âš ï¸ GitHub APIì—ì„œ íŒŒì¼ì„ ì°¾ì§€ ëª»í•¨, ê¸°ë³¸ ëª©ë¡ ì‚¬ìš©');
                    }
                } else {
                    console.log(`âš ï¸ GitHub API ì‘ë‹µ ì‹¤íŒ¨ (${response.status}), ê¸°ë³¸ ëª©ë¡ ì‚¬ìš©`);
                }
            } catch (error) {
                console.log('ğŸ”„ GitHub API ì˜¤ë¥˜, ê¸°ë³¸ ëª©ë¡ ì‚¬ìš©:', error.message);
            }

            try {

                                // ê° í¬ìŠ¤íŠ¸ íŒŒì¼ì„ ë¡œë“œí•˜ê³  ë©”íƒ€ë°ì´í„° ì¶”ì¶œ
                for (const postInfo of postsList) {
                    const filename = postInfo.filename;
                    try {
                        const response = await fetch(`/posts/${filename}`);
                        if (response.ok) {
                            const content = await response.text();
                            const parsed = matter(content);
                            
                            posts.push({
                                filename: filename.replace('.md', ''),
                                title: parsed.data.title || 'ì œëª© ì—†ìŒ',
                                date: parsed.data.date || new Date(),
                                content: parsed.content,
                                summary: generateSummary(parsed.content)
                            });
                        }
                    } catch (error) {
                        console.error(`Error loading ${filename}:`, error);
                    }
                }
            } catch (error) {
                console.error('Error loading posts list:', error);
                // ì˜¤ë¥˜ ë°œìƒ ì‹œ ë¹ˆ ë°°ì—´ë¡œ ì²˜ë¦¬
            }

            // ë‚ ì§œìˆœìœ¼ë¡œ ì •ë ¬ (ìµœì‹ ìˆœ)
            posts.sort((a, b) => new Date(b.date) - new Date(a.date));

            // HTML ìƒì„±
            if (posts.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 2rem;"><p>ì•„ì§ ê²Œì‹œëœ ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
                return;
            }

            const postsHtml = posts.map(post => {
                const formattedDate = new Date(post.date).toLocaleDateString('ko-KR', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });

                return `
                    <div class="post-item">
                        <h3><a href="post.html?p=${encodeURIComponent(post.filename)}">${post.title}</a></h3>
                        <p class="post-meta">ì‘ì„±ì¼: ${formattedDate}</p>
                        <p>${post.summary}</p>
                        <a href="post.html?p=${encodeURIComponent(post.filename)}" class="read-more">ë” ì½ê¸° &rarr;</a>
                    </div>
                `;
            }).join('');

            container.innerHTML = postsHtml;
        }

        function generateSummary(content) {
            // ë§ˆí¬ë‹¤ìš´ì—ì„œ í…ìŠ¤íŠ¸ë§Œ ì¶”ì¶œí•˜ê³  ìš”ì•½ ìƒì„±
            const textOnly = content
                .replace(/#{1,6}\s/g, '') // í—¤ë”© ì œê±°
                .replace(/\*\*(.*?)\*\*/g, '$1') // ë³¼ë“œ ì œê±°
                .replace(/\*(.*?)\*/g, '$1') // ì´íƒ¤ë¦­ ì œê±°
                .replace(/\[(.*?)\]\(.*?\)/g, '$1') // ë§í¬ ì œê±°
                .replace(/```[\s\S]*?```/g, '') // ì½”ë“œë¸”ë¡ ì œê±°
                .replace(/`(.*?)`/g, '$1') // ì¸ë¼ì¸ ì½”ë“œ ì œê±°
                .replace(/\n/g, ' ') // ì¤„ë°”ê¿ˆì„ ê³µë°±ìœ¼ë¡œ
                .trim();
            
            // ì²« 150ìë¡œ ìš”ì•½
            return textOnly.length > 150 ? textOnly.substring(0, 150) + '...' : textOnly;
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ëª©ë¡ ìƒì„±
        document.addEventListener('DOMContentLoaded', loadBlogPosts);
    </script>

</body>
</html> 